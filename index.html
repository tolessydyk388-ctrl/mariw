<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MARI ‚Äî –ó–∞–∫–∞–∑ –µ–¥—ã</title>

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#F6F4F1;
  --card:#fff;
  --accent:#B89B7C;
  --accent-hover:#A88A6A;
  --text:#2E2E2E;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Cormorant Garamond',serif;
  background:var(--bg);
  color:var(--text);
  overflow-x:hidden;
}

/* ===== –ê–ù–ò–ú–ê–¶–ò–ò ===== */
.fade-down{animation:fadeDown .8s cubic-bezier(.2,.8,.2,1)}
@keyframes fadeDown{from{opacity:0;transform:translateY(-40px)}to{opacity:1}}

.hidden{display:none}

/* ===== –ü–ö ===== */
.pc-select{min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px}
.pc-card{
  background:#fff;padding:36px;border-radius:24px;
  width:100%;max-width:360px;text-align:center;
  box-shadow:0 25px 60px rgba(0,0,0,.15)
}

select,textarea,button{
  width:100%;padding:14px;margin-top:14px;
  font-size:18px;border-radius:12px;border:1px solid #ddd;font-family:inherit
}

button{
  background:var(--accent);color:#fff;border:none;
  cursor:pointer;transition:.25s
}
button:hover{background:var(--accent-hover);transform:translateY(-1px)}
button:active{transform:scale(.96)}

.container{max-width:560px;margin:auto;padding:16px}

/* ===== –ú–ï–ù–Æ ===== */
.category{margin-bottom:14px}
.category-title{
  background:#fff;padding:16px;border-radius:16px;
  font-weight:600;cursor:pointer;
  box-shadow:0 6px 18px rgba(0,0,0,.08)
}
.category-items{max-height:0;overflow:hidden;transition:max-height .45s ease}
.category.open .category-items{max-height:3000px}

.menu-row{
  background:#fff;border-radius:14px;padding:12px;
  margin:10px 0;display:flex;justify-content:space-between;
  animation:item .3s ease
}
@keyframes item{from{opacity:0;transform:translateY(-10px)}to{opacity:1}}

/* ===== –ö–û–†–ó–ò–ù–ê ===== */
.cart-btn{
  position:fixed;right:16px;bottom:16px;
  width:56px;height:56px;border-radius:50%;
  background:var(--accent);color:#fff;font-size:24px;
  display:flex;justify-content:center;align-items:center;
  box-shadow:0 6px 20px rgba(0,0,0,.3);z-index:10
}
.cart-count{
  position:absolute;top:-6px;right:-6px;
  background:red;width:20px;height:20px;border-radius:50%;
  font-size:12px;display:flex;align-items:center;justify-content:center
}

.cart-panel{
  position:fixed;top:0;right:0;width:90%;max-width:400px;height:100%;
  background:#fff;padding:16px;transform:translateX(100%);
  transition:.4s;z-index:20;display:flex;flex-direction:column
}
.cart-panel.open{transform:none}

.cart-header{display:flex;justify-content:space-between;align-items:center}
.cart-header button{
  width:28px;height:28px;padding:0;border-radius:8px;
  background:#eee;color:#333
}

.cart-item{display:flex;justify-content:space-between;margin-bottom:6px}
.cart-item button{
  width:22px;height:22px;padding:0;
  background:#e74c3c;border-radius:6px;font-size:12px
}

/* ===== OVERLAY ===== */
.overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.45);
  display:none;align-items:center;justify-content:center;z-index:50
}
.overlay.show{display:flex}
.success{
  background:#fff;padding:30px;border-radius:20px;
  text-align:center;animation:fadeDown .4s
}

/* ===== –ü–û–õ–Å–¢ ===== */
.fly{
  position:fixed;z-index:999;pointer-events:none;
  animation:fly .7s cubic-bezier(.4,0,.2,1)
}
@keyframes fly{
  to{transform:translate(var(--x),var(--y)) scale(.1);opacity:0}
}
</style>
</head>

<body>

<!-- –ü–ö -->
<div id="stepPc" class="pc-select fade-down">
  <div class="pc-card">
    <h2>MARI coffee & terace</h2>
    <p>–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –ü–ö</p>
    <select id="pcNumber"></select>
    <button onclick="goToMenu()">–ü–µ—Ä–µ–π—Ç–∏ –∫ –º–µ–Ω—é</button>
  </div>
</div>

<!-- –ú–ï–ù–Æ -->
<div id="stepMenu" class="hidden fade-down">
  <div class="container">
    <h2>–ú–µ–Ω—é ¬∑ –ü–ö ‚Ññ <span id="pcLabel"></span></h2>
    <div id="menu"></div>
  </div>
</div>

<!-- –ö–û–†–ó–ò–ù–ê -->
<div class="cart-btn" onclick="toggleCart()">üõí
  <div class="cart-count" id="cartCount">0</div>
</div>

<div class="cart-panel" id="cartPanel">
  <div class="cart-header">
    <strong>–ö–æ—Ä–∑–∏–Ω–∞</strong>
    <button onclick="toggleCart()">‚úï</button>
  </div>
  <div id="cartItems" style="flex:1;overflow:auto;margin:10px 0"></div>
  <textarea id="comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"></textarea>
  <button onclick="confirmOrder()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
</div>

<!-- –£–°–ü–ï–• -->
<div class="overlay" id="successOverlay">
  <div class="success">
    <h2>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –∑–∞–∫–∞–∑!</h2>
    <p>–û–∂–∏–¥–∞–π—Ç–µ –¥–æ—Å—Ç–∞–≤–∫—É –∫ –≤–∞—à–µ–º—É –ü–ö</p>
    <button onclick="location.reload()">–û–ö</button>
  </div>
</div>

<script>
/* ===== –ù–ê–°–¢–†–û–ô–ö–ò TELEGRAM ===== */
const TG_BOT_TOKEN = '8591575115:AAERzHGB3da6TzPZPa4W4vE4Iupk_Qia40Q';
const TG_CHAT_ID = '883017812';

/* ===== –ü–ö ===== */
const pcSelect=document.getElementById('pcNumber');
for(let i=1;i<=40;i++)pcSelect.innerHTML+=`<option value="${i}">–ü–ö ${i}</option>`;

/* ===== –ú–ï–ù–Æ ===== */
const menuData=[
{name:'–≠—Å–ø—Ä–µ—Å—Å–æ 30 –º–ª',price:1290},
{name:'–ê–º–µ—Ä–∏–∫–∞–Ω–æ 230 –º–ª',price:1590},
{name:'–ö–∞–ø—É—á–∏–Ω–æ 230 –º–ª',price:1990},
{name:'–õ–∞—Ç—Ç–µ 340 –º–ª',price:2290},
{name:'–†–∞—Ñ 240 –º–ª',price:2290},
{name:'–ú–µ–¥–æ–≤–∏–∫',price:2590},
{name:'–ß–∏–∑–∫–µ–π–∫',price:3290},
{name:'Mojito 300 –º–ª',price:2490}
];

const categories={
  "–ö–æ—Ñ–µ":menuData.slice(0,4),
  "–î–µ—Å–µ—Ä—Ç—ã":menuData.slice(4,6),
  "–ö–æ–∫—Ç–µ–π–ª–∏":menuData.slice(6)
};

const cart=[];

/* ===== –õ–û–ì–ò–ö–ê ===== */
function goToMenu(){
  stepPc.classList.add('hidden');
  stepMenu.classList.remove('hidden');
  pcLabel.innerText=pcSelect.value;
  renderMenu();
}

function renderMenu(){
  menu.innerHTML='';
  Object.keys(categories).forEach(cat=>{
    const c=document.createElement('div');
    c.className='category';
    c.innerHTML=`<div class="category-title" onclick="this.parentNode.classList.toggle('open')">${cat}</div><div class="category-items"></div>`;
    const items=c.querySelector('.category-items');
    categories[cat].forEach(i=>{
      items.innerHTML+=`<div class="menu-row"><span>${i.name}</span><span>${i.price} ‚Ç∏ <button onclick="addToCart('${i.name}',${i.price});fly(this)">Ôºã</button></span></div>`;
    });
    menu.appendChild(c);
  });
}

function addToCart(name,price){cart.push({name,price});renderCart()}
function renderCart(){
  cartItems.innerHTML='';
  let sum=0;
  cart.forEach((i,idx)=>{
    sum+=i.price;
    cartItems.innerHTML+=`<div class="cart-item"><span>${i.name}</span><span>${i.price} ‚Ç∏ <button onclick="cart.splice(${idx},1);renderCart()">‚úï</button></span></div>`;
  });
  cartItems.innerHTML+=`<strong>–ò—Ç–æ–≥–æ: ${sum} ‚Ç∏</strong>`;
  cartCount.innerText=cart.length;
}

function toggleCart(){cartPanel.classList.toggle('open')}

/* ===== –ö–õ–ò–ö –í–ù–ï –ö–û–†–ó–ò–ù–´ ===== */
document.addEventListener('click',e=>{
  if(cartPanel.classList.contains('open')&&!cartPanel.contains(e.target)&&!e.target.closest('.cart-btn')){
    toggleCart();
  }
});

/* ===== –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï ===== */
function confirmOrder(){
  if(!cart.length)return alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');
  if(confirm('–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑?'))sendOrder();
}

/* ===== –û–¢–ü–†–ê–í–ö–ê ===== */
function sendOrder(){
  const text=`üßæ –ó–∞–∫–∞–∑\n–ü–ö: ${pcSelect.value}\n${cart.map(i=>i.name).join(', ')}\nüí∞ ${cart.reduce((a,b)=>a+b.price,0)} ‚Ç∏\nüí¨ ${comment.value}`;

  fetch(`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage`,{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({chat_id:TG_CHAT_ID,text})
  });

  fetch('https://script.google.com/macros/s/AKfycbwUf4ivkksaNwsq6AliAYCHdeqQASZeKVUZ1SE8ZTOZNUK56NA8a-26Chb0ypsP2kcxgw/exec',{
    method:'POST',
    body:JSON.stringify({pc:pcSelect.value,items:cart.map(i=>i.name).join(', '),sum:cart.reduce((a,b)=>a+b.price,0),comment:comment.value})
  })
  
  .then(()=>{
    successOverlay.classList.add('show');

    
  });
}

/* ===== –ü–û–õ–Å–¢ ===== */
function fly(btn){
  const r=btn.getBoundingClientRect();
  const c=document.querySelector('.cart-btn').getBoundingClientRect();
  const f=document.createElement('div');
  f.className='fly';f.textContent='Ôºã';
  f.style.left=r.left+'px';f.style.top=r.top+'px';
  f.style.setProperty('--x',c.left-r.left+'px');
  f.style.setProperty('--y',c.top-r.top+'px');
  document.body.appendChild(f);
  setTimeout(()=>f.remove(),700);
}

const orderSound = new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg');

function playOrderEffects(){
  orderSound.play().catch(()=>{});
  if(navigator.vibrate){
    navigator.vibrate([200,100,200]);
  }
}


document.addEventListener('click',e=>{
  if(
    cartPanel.classList.contains('open') &&
    !cartPanel.contains(e.target) &&
    !e.target.closest('.cart-btn')
  ){
    cartPanel.classList.remove('open');
  }
});

</script>



</body>
</html>
